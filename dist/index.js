const Transform=require("stream").Transform,compiler=require("webassembly/cli/compiler"),fs=require("fs"),path=require("path");function buildWasm(n="c_cpp",c="wasm"){var s=new Transform({objectMode:!0});return s._transform=function(e,s,r){console.log(e.path);var o="./"+c,i=null,t=e;fs.existsSync(o)||fs.mkdirSync(o,!0);var a=e.path.split("\\").pop().split("/").pop().split(".")[0],l=(null===(l=e.path.split(n)[1])||void 0===l?void 0:l.split(a)[0])||"";let p=path.resolve(o+l,a+".wasm");fs.existsSync(o+l)||fs.mkdirSync(o+l,{recursive:!0}),compiler.main(["-o",p,e.path],function(s,r){s?i=s:console.log(e.path+" saved to: "+p)}),r(i,t)},s}module.exports=buildWasm;